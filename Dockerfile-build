FROM nvidia/cuda:12.4.1-cudnn-devel-ubuntu22.04

WORKDIR /workdir

RUN apt-get update && \
    apt-get install -y git python3-pip && \
    apt-get clean && rm -rf /var/lib/apt/lists/*

# Copy local version of deforum-studio
COPY ./workdir/deforum-studio workdir/deforum

WORKDIR /workdir/deforum
RUN pip install -e .[cli]

# Clone ComfyUI into the correct location
RUN git clone https://github.com/comfyanonymous/ComfyUI.git /workdir/deforum/src/ComfyUI

WORKDIR /workdir/deforum
